package com.cheddd.view;

import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.RectF;
import android.util.AttributeSet;
import android.view.View;

/**
 * Created by Administrator on 2017/3/16 0016.
 */

public class CircleProgressBar extends View {
    private Paint mPaint;
    private int mProgress;
    private int mRadius;

    public CircleProgressBar(Context context) {
        super(context);
        mPaint = new Paint();
    }

    public CircleProgressBar(Context context, AttributeSet attrs) {
        super(context, attrs);
        mPaint = new Paint();
    }

    public CircleProgressBar(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
        mPaint = new Paint();
    }

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        String text = 300 * mProgress + "";
        String text1 = "可借额度(元)";
        float textwidth = mPaint.measureText(text);
        float textwidth1 = mPaint.measureText(text1);
        mPaint.setColor(Color.RED);
        //设置抗锯齿
        mPaint.setAntiAlias(true);
        //设置圆的实心还是虚心  //style.fill为实心
        mPaint.setStyle(Paint.Style.STROKE);
        int width = getWidth();
        int height = getHeight();
        //得到半径,取宽和高的最小值
        mRadius = (Math.min(width, height)) / 2;
        canvas.drawCircle(mRadius, mRadius, mRadius, mPaint);
        mPaint.setColor(Color.GREEN);
        RectF rectf = new RectF(0, 0, mRadius * 2, mRadius * 2);
        float endarc = mProgress / 100f * 360;
        canvas.drawArc(rectf, 0, endarc, false, mPaint);
        mPaint.setColor(Color.RED);
        mPaint.setTextSize(31);
        canvas.drawText(text, (mRadius * 2 - textwidth) / 2, (mRadius * 2 - mPaint.ascent() - mPaint.descent()) / 2, mPaint);
        canvas.drawText(text1, (mRadius * 2 - textwidth) / 7, (mRadius * 2 - mPaint.ascent() - mPaint.descent()) / 3, mPaint);
    }

    public void setProgress(int progress) {
        mProgress = progress;
        invalidate();
    }
}
