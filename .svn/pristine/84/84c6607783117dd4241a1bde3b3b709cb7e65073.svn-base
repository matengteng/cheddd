package com.cheddd.activity;

import android.content.DialogInterface;
import android.content.Intent;
import android.support.v7.app.AlertDialog;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.text.TextUtils;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RelativeLayout;
import android.widget.TextView;

import com.cheddd.R;
import com.cheddd.base.MyBaseActivity;
import com.cheddd.utils.ToastUtil;

//信息认证
public class StatsApproveActivity extends MyBaseActivity implements View.OnClickListener {

    //姓名，身份证号，手机号码,详细地址
    private EditText mEditTextName, mEditTextIDCard, mEditTextPhone, mEditTextDetalis, mEditTextSex;
    //性别，婚姻，教育，户籍，联系人，工作信息，居住；
    private RelativeLayout mRelativeSex, mRelativeMarriage, mRelativeEducaton, mRelativeHousehold,
            mRelativeRelation, mRelativeWork, mRelativeLive;
    //提交
    private Button mButtonSubmit;
    private TextView mTextViewSex, mTextViewMarriage, mTextViewEducation;
    private int position = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_stats_approve);
        initView();
        setListener();
    }

    private void setListener() {
        mButtonSubmit.setOnClickListener(this);
        //mRelativeSex.setOnClickListener(this);
        mTextViewSex.setOnClickListener(this);
        mRelativeHousehold.setOnClickListener(this);
        mTextViewMarriage.setOnClickListener(this);
        mTextViewEducation.setOnClickListener(this);
        mTextViewMarriage.setOnClickListener(this);
        mRelativeWork.setOnClickListener(this);
    }

    private void initView() {
        mButtonSubmit = (Button) findViewById(R.id.bt_stats_input);
        mEditTextDetalis = (EditText) findViewById(R.id.et_stats_details);
        mEditTextIDCard = (EditText) findViewById(R.id.et_stats_IDCard);
        mEditTextPhone = (EditText) findViewById(R.id.et_stats_phone);
        mEditTextName = (EditText) findViewById(R.id.et_stats_name);
        mRelativeEducaton = (RelativeLayout) findViewById(R.id.rl_stats_education);
        mRelativeHousehold = (RelativeLayout) findViewById(R.id.rl_stats_household);
        mRelativeMarriage = (RelativeLayout) findViewById(R.id.rl_stats_marriage);
        mRelativeRelation = (RelativeLayout) findViewById(R.id.rl_stats_relation);
        mRelativeLive = (RelativeLayout) findViewById(R.id.rl_stats_live);
        // mRelativeSex = (RelativeLayout) findViewById(R.id.rl_stats_sex);
        mRelativeWork = (RelativeLayout) findViewById(R.id.rl_stats_work);
        mTextViewSex = (TextView) findViewById(R.id.tv_stats_sex);
        mTextViewEducation = (TextView) findViewById(R.id.tv_stats_educations);
        mTextViewMarriage = (TextView) findViewById(R.id.tv_stats_marriage);

    }

    @Override
    public void onClick(View v) {
        if (v != null) {
            switch (v.getId()) {
                case R.id.bt_stats_input:
                    submit();
                    break;
                case R.id.tv_stats_sex:
                    change_sex();
                    break;
                case R.id.rl_stats_household:
                    break;
                case R.id.tv_stats_education:
                    education();
                    break;
                case R.id.tv_stats_marriage:
                    marriage();
                    break;
                case R.id.rl_stats_work:
                    Intent intent=new Intent(StatsApproveActivity.this,WorkActivity.class);
                    startActivity(intent);
                    break;
            }
        }
    }

    private void marriage() {
        final AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setSingleChoiceItems(R.array.marriage, position, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int which) {
                position = which;
                final String[] aryShop = getResources().getStringArray(R.array.sex);
                mTextViewSex.setText(aryShop[which]);
                dialog.dismiss();
            }
        }).create().show();
    }

    private void education() {
        final AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setSingleChoiceItems(R.array.education, position, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int which) {
                position = which;
                final String[] aryShop = getResources().getStringArray(R.array.sex);
                mTextViewSex.setText(aryShop[which]);
                dialog.dismiss();
            }
        }).create().show();
    }

    //性别的选择
    private void change_sex() {
        final AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setSingleChoiceItems(R.array.sex, position, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int which) {
                position = which;
                final String[] aryShop = getResources().getStringArray(R.array.sex);
                mTextViewSex.setText(aryShop[which]);
                dialog.dismiss();
            }
        }).create().show();
       /* builder.setItems(R.array.sex, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialog, int which) {
                final String[] aryShop = getResources().getStringArray(R.array.sex);
                mTextViewSex.setText(aryShop[which]);

            }
        }).create().show();*/

    }


    //提交的界面
    private void submit() {
        //用户名
        String name = mEditTextName.getText().toString().trim();
        if (TextUtils.isEmpty(name)) {
            ToastUtil.show(this, "姓名不能为空");
            return;
        }
        String nameRegular = "[\u4E00-\u9FA5]{2,5}(?:·[\u4E00-\u9FA5]{2,5})*";
        if (!name.matches(nameRegular)) {
            ToastUtil.show(this, "姓名格式错误");
            return;
        }
        //身份证号码的判断
        String IdCard = mEditTextIDCard.getText().toString().trim();
        if (TextUtils.isEmpty(IdCard)) {
            return;
        }
        if (!IdCard.matches("/^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}([0-9]|X)$/")) {
            ToastUtil.show(this, "身份证格式错误");
            return;
        }
        //手机号码
        String phone = mEditTextPhone.getText().toString().trim();
        if (TextUtils.isEmpty(phone)) {
            ToastUtil.show(this, "手机号不能为空");
            return;
        }
        if (!phone.matches("1\\d{10}")) {
            ToastUtil.show(this, "手机格式错误");
            return;
        }
    }
}
